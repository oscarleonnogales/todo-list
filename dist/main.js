(()=>{const t="task.lists",e="task.selectedListId";let n=JSON.parse(localStorage.getItem(t))||[],a=localStorage.getItem(e);const o=document.querySelector("[data-lists");o.addEventListener("click",(t=>{"li"===t.target.tagName.toLowerCase()&&(a=t.target.dataset.listId,f())}));const l=document.querySelector("[data-new-list-form]"),s=document.querySelector("[data-new-list-input]");l.addEventListener("submit",(t=>{t.preventDefault();const e=s.value,o=n.some((t=>t.name.toUpperCase()===e.toUpperCase()));if(null==e||""===e)return;if(s.value=null,o)return void alert("That list is already included");const l={name:e,id:Date.now().toString(),tasks:[]};a=l.id,n.push(l),f()}));const d=document.querySelector("[data-new-task-form]"),i=document.querySelector("[data-new-task-input]");d.addEventListener("submit",(t=>{t.preventDefault();const e=i.value;if(null==e||""===e)return;const o=function(t){return{id:Date.now().toString(),name:t,completed:!1}}(e);n.find((t=>t.id===a)).tasks.push(o),i.value=null,f()})),g(),document.querySelector("[data-delete-list-button]").addEventListener("click",(t=>{n=n.filter((t=>t.id!==a)),a=null,f()}));const c=document.querySelector("[data-current-list-container]"),r=document.querySelector("[data-current-list-title]"),u=document.querySelector("[data-task-counter]"),m=document.querySelector("[data-tasks]");function f(){p(),g(),function(){if(null==a)c.style.display="none";else{let t=n.find((t=>t.id===a));c.style.display="",r.innerText=t.name,S(t),y(m),t.tasks.forEach((t=>{const e=document.importNode(k.content,!0),n=e.querySelector("input");n.checked=t.completed,n.id=t.id;const a=e.querySelector("label");a.htmlFor=t.id,a.append(t.name),m.appendChild(e)}))}}()}function p(){localStorage.setItem(t,JSON.stringify(n)),localStorage.setItem(e,a)}m.addEventListener("click",(t=>{if("input"===t.target.tagName.toLowerCase()){const e=n.find((t=>t.id===a));console.log(e);const o=e.tasks.find((e=>e.id===t.target.id));console.log(o),o.completed=t.target.checked,p(),S(e)}})),document.querySelector("[data-clear-completed-tasks-button]").addEventListener("click",(()=>{const t=n.find((t=>t.id===a));t.tasks=t.tasks.filter((t=>!t.completed)),f()}));const k=document.querySelector("[data-task-template]");function S(t){const e=t.tasks.filter((t=>!t.completed)).length,n=1===e?"task":"tasks";u.innerText=`${e} ${n} remaining`}function g(){y(o),n.forEach((t=>{const e=document.createElement("li");e.innerHTML=t.name,e.dataset.listId=t.id,t.id===a&&e.classList.add("active"),o.appendChild(e)}))}function y(t){for(;t.firstChild;)t.removeChild(t.firstChild)}})();